# Boltz Backend Configuration - Mainnet
# Integration with existing Lightning.space infrastructure

# Network Configuration - MUST be at top level before any sections!
network = "mainnet"

loglevel = "debug"

[api]
host = "0.0.0.0"
port = 9001
allowedCors = ["*"]

[grpc]
host = "0.0.0.0"
port = 9000

# Sidecar Configuration (Rust component)
[sidecar]
  [sidecar.grpc]
  host = "0.0.0.0"
  port = 9003
  certificates = "/root/.boltz/sidecar/certificates"

  [sidecar.ws]
  host = "0.0.0.0"
  port = 9004

  [sidecar.api]
  host = "0.0.0.0"
  port = 9005

# PostgreSQL Database
[postgres]
host = "postgres"
port = 5432
database = "[POSTGRES_DATABASE]"
username = "[POSTGRES_USERNAME]"
password = "[POSTGRES_PASSWORD]"

# Redis Cache (optional but recommended)
[cache]
redisEndpoint = "redis://redis:6379"

# Bitcoin/Lightning Configuration
[[currencies]]
symbol = "BTC"
network = "bitcoinMainnet"

# Wallet balances - adjusted for testing
minWalletBalance = 100_000  # 0.001 BTC (100k sats)
minChannelBalance = 100_000  # 0.001 BTC (100k sats)

# Swap limits
maxSwapAmount = 10_000_000  # 0.1 BTC maximum
minSwapAmount = 2_500       # 2,500 sats minimum (currency level - for all BTC swaps)
maxZeroConfAmount = 0       # Disable 0-conf for security

  # Bitcoin Core Configuration
  [currencies.chain]
  host = "bitcoind"
  port = 8332

  # RPC Authentication
  user = "[RPC_USER]"
  password = "[RPC_PASSWORD]"

  # ZMQ endpoints for blockchain notifications
  zmqpubrawtx = "tcp://bitcoind:28333"
  zmqpubrawblock = "tcp://bitcoind:28332"

  # Bitcoin wallet name
  wallet = "[WALLET_NAME]"

  # LND Configuration
  [currencies.lnd]
  host = "lnd"
  port = 10009  # gRPC port (not REST 8080!)

  # Credentials - mounted from Docker volumes
  certpath = "/root/.lnd/tls.cert"
  macaroonpath = "/root/.lnd/data/chain/bitcoin/mainnet/admin.macaroon"

# Swap Pair Configuration: BTC/BTC (Lightning <-> OnChain)
[[pairs]]
base = "BTC"
quote = "BTC"
rate = 1  # 1:1 exchange rate

# Fee configuration (in percent)
fee = 0.5          # 0.5% service fee
swapInFee = 0.25   # 0.25% for submarine swaps (chain -> lightning)

# Swap amount limits (in satoshis)
maxSwapAmount = 10_000_000  # 0.1 BTC
minSwapAmount = 2_500       # 2,500 sats (pair level)

  # Submarine Swap specific settings (Chain -> Lightning)
  [pairs.submarineSwap]
  minSwapAmount = 10_000   # Minimum for submarine swaps (needs high limit due to on-chain fees)

  # Reverse Swap specific settings (Lightning -> Chain)
  [pairs.reverseSwap]
  minSwapAmount = 2_500    # Minimum for reverse swaps (lower fees, no input tx)

  # Timeout configuration (in minutes!)
  [pairs.timeoutDelta]
  chain = 1440        # Chain swap timeout (~24 hours = 144 blocks)
  reverse = 1440      # ~24 hours for reverse swaps (lightning -> chain)
  swapMinimal = 1440  # Minimum timeout for submarine swaps (~24 hours = 144 blocks)
  swapMaximal = 2880  # Maximum timeout (~48 hours = 288 blocks)
  swapTaproot = 10080 # 1 week for taproot swaps (10080 blocks)

# Swap Pair Configuration: BTC/RBTC (Lightning BTC <-> RSK RBTC)
[[pairs]]
base = "BTC"
quote = "RBTC"
rate = 1  # 1:1 peg between BTC and RBTC

# Fee configuration (in percent)
fee = 0.25
swapInFee = 0.1

# Swap amount limits (in satoshis)
maxSwapAmount = 10_000_000  # 0.1 BTC/RBTC
minSwapAmount = 2_500       # 2,500 sats minimum (Rootstock has lower fees)

  [pairs.timeoutDelta]
  chain = 1440        # Chain swap timeout (~24 hours)
  reverse = 1440      # Reverse swap timeout (Lightning -> RBTC)
  swapMinimal = 1440  # Minimum timeout
  swapMaximal = 2880  # Maximum timeout
  swapTaproot = 10080

# RSK (Rootstock) Configuration
[rsk]
networkName = "RSK Mainnet"
providerEndpoint = "[PROVIDER_ENDPOINT]"

 [[rsk.contracts]]
 etherSwap = "0x3d9cc5780CA1db78760ad3D35458509178A85A4A"
 erc20Swap = "0x7d5a2187CC8EF75f8822daB0E8C9a2DB147BA045"

 [[rsk.tokens]]
 symbol = "RBTC"

 maxSwapAmount = 10_000_000
 minSwapAmount = 2_500

 minWalletBalance = 10_000
