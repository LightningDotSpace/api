# Boltz Backend Configuration - Mainnet
# Integration with existing Lightning.space infrastructure

# Network Configuration - MUST be at top level before any sections!
network = "mainnet"

loglevel = "debug"

[api]
host = "0.0.0.0"
port = 9001
allowedCors = ["*"]

[grpc]
host = "0.0.0.0"
port = 9000

# Sidecar Configuration (Rust component)
[sidecar]
  [sidecar.grpc]
  host = "0.0.0.0"
  port = 9003
  certificates = "/root/.boltz/sidecar/certificates"

  [sidecar.ws]
  host = "0.0.0.0"
  port = 9004

  [sidecar.api]
  host = "0.0.0.0"
  port = 9005

# PostgreSQL Database
[postgres]
host = "postgres"
port = 5432
database = "[POSTGRES_DATABASE]"
username = "[POSTGRES_USERNAME]"
password = "[POSTGRES_PASSWORD]"

# Redis Cache (optional but recommended)
[cache]
redisEndpoint = "redis://redis:6379"

[swap]
deferredClaimSymbols = ["cBTC"]

# Bitcoin/Lightning Configuration
[[currencies]]
symbol = "BTC"
network = "bitcoinMainnet"

# Wallet balances - adjusted for testing
minWalletBalance = 100_000  # 0.001 BTC (100k sats)
minChannelBalance = 100_000 # 0.001 BTC (100k sats)

# Swap limits
maxSwapAmount = 10_000_000  # 0.1 BTC maximum
minSwapAmount = 2_500       # 2,500 sats minimum (currency level - for all BTC swaps)
maxZeroConfAmount = 0       # Disable 0-conf for security

  # Bitcoin Core Configuration
  [currencies.chain]
  host = "bitcoind"
  port = 8332

  # RPC Authentication
  user = "[RPC_USER]"
  password = "[RPC_PASSWORD]"

  # ZMQ endpoints for blockchain notifications
  zmqpubrawtx = "tcp://bitcoind:28333"
  zmqpubrawblock = "tcp://bitcoind:28332"

  # Bitcoin wallet name
  wallet = "[WALLET_NAME]"

  # LND Configuration
  [currencies.lnd]
  host = "lnd"
  port = 10009  # gRPC port (not REST 8080!)

  # Credentials - mounted from Docker volumes
  certpath = "/root/.lnd/tls.cert"
  macaroonpath = "/root/.lnd/data/chain/bitcoin/mainnet/admin.macaroon"

# Swap Pair Configuration: BTC/BTC (Lightning <-> OnChain)
[[pairs]]
base = "BTC"
quote = "BTC"
rate = 1
fee = 0.5        # 0.5% service fee
swapInFee = 0.25 # 0.25% for submarine swaps (chain -> lightning)

# Swap amount limits (in satoshis)
maxSwapAmount = 10_000_000 # 0.1 BTC
minSwapAmount = 2_500      # 2,500 sats (pair level)

  # Submarine Swap specific settings (Chain -> Lightning)
  [pairs.submarineSwap]
  minSwapAmount = 10_000   # Minimum for submarine swaps (needs high limit due to on-chain fees)

  # Reverse Swap specific settings (Lightning -> Chain)
  [pairs.reverseSwap]
  minSwapAmount = 2_500    # Minimum for reverse swaps (lower fees, no input tx)

  # Timeout configuration (in minutes!)
  [pairs.timeoutDelta]
  chain = 1440        # Chain swap timeout (~24 hours = 144 blocks)
  reverse = 1440      # ~24 hours for reverse swaps (lightning -> chain)
  swapMinimal = 1440  # Minimum timeout for submarine swaps (~24 hours = 144 blocks)
  swapMaximal = 2880  # Maximum timeout (~48 hours = 288 blocks)
  swapTaproot = 10080 # 1 week for taproot swaps (10080 blocks)

[[pairs]]
base = "BTC"
quote = "cBTC"
rate = 1
fee = 0.25
swapInFee = 0.1

maxSwapAmount = 10_000_000 # 0.1 BTC/cBTC
minSwapAmount = 2_500      # 2,500 sats minimum (Citrea Testnet has low fees)

  [pairs.timeoutDelta]
  chain = 60          # Chain swap timeout (~1 hour, due to fast 2s blocks)
  reverse = 180       # Reverse swap timeout (Lightning -> cBTC) - increased for CLTV requirements
  swapMinimal = 1440  # Minimum timeout (~13.3 hours) - minimum for Lightning CLTV (80 blocks Ã— 10 min)
  swapMaximal = 2880  # Maximum timeout (~16.7 hours) - allows 100 Bitcoin blocks CLTV
  swapTaproot = 10080 # Taproot timeout (~16.7 hours)

[[pairs]]
base = "USDT_ETH"
quote = "JUSD_CITREA"
rate = 1
fee = 0.25
swapInFee = 0.1

maxSwapAmount = 10_000_000_000 # 10,000 USDT_ETH/JUSD_CITREA
minSwapAmount = 1_000_000      # 1 USDT_ETH/JUSD_CITREA

  [pairs.timeoutDelta]
  chain = 1440        # Chain swap timeout (~24 hours = 144 blocks)
  reverse = 1440      # ~24 hours for reverse swaps (lightning -> chain)
  swapMinimal = 1440  # Minimum timeout for submarine swaps (~24 hours = 144 blocks)
  swapMaximal = 2880  # Maximum timeout (~48 hours = 288 blocks)
  swapTaproot = 10080 # 1 week for taproot swaps (10080 blocks)

[[pairs]]
base = "USDT_POLYGON"
quote = "JUSD_CITREA"
rate = 1
fee = 0.25
swapInFee = 0.1

maxSwapAmount = 10_000_000_000 # 10,000 USDT_POLYGON/JUSD_CITREA
minSwapAmount = 1_000_000      # 1 USDT_POLYGON/JUSD_CITREA

  [pairs.timeoutDelta]
  chain = 1440        # Chain swap timeout (~24 hours = 144 blocks)
  reverse = 1440      # ~24 hours for reverse swaps (lightning -> chain)
  swapMinimal = 1440  # Minimum timeout for submarine swaps (~24 hours = 144 blocks)
  swapMaximal = 2880  # Maximum timeout (~48 hours = 288 blocks)
  swapTaproot = 10080 # 1 week for taproot swaps (10080 blocks)

# ETH (Ethereum) Configuration
[ethereum]
networkName = "Ethereum Mainnet"
providerEndpoint = "[PROVIDER_ENDPOINT]"

  [[ethereum.contracts]]
  etherSwap = "0x9ADfB0F1B783486289Fc23f3A3Ad2927cebb17e4"
  erc20Swap = "0x2E21F58Da58c391F110467c7484EdfA849C1CB9B"

  [[ethereum.tokens]]
  symbol = "USDT_ETH"
  decimals = 6
  contractAddress = "0xdAC17F958D2ee523a2206206994597C13D831ec7"

  minWalletBalance = 1_000_000   # 1 USDT_ETH

# POL (Polygon) Configuration
[polygon]
networkName = "Polygon Mainnet"
providerEndpoint = "[PROVIDER_ENDPOINT]"

  [[polygon.contracts]]
  etherSwap = "0x9ADfB0F1B783486289Fc23f3A3Ad2927cebb17e4"
  erc20Swap = "0x2E21F58Da58c391F110467c7484EdfA849C1CB9B"

  [[polygon.tokens]]
  symbol = "USDT_POLYGON"
  decimals = 6
  contractAddress = "0xc2132D05D31c914a87C6611C10748AEb04B58e8F"

  minWalletBalance = 1_000_000   # 1 USDT_POLYGON

# Citrea Testnet Configuration
[citrea]
networkName = "Citrea Testnet"
providerEndpoint = "https://dev.rpc.testnet.juiceswap.com"

  [[citrea.contracts]]
  etherSwap = "0xd02731fD8c5FDD53B613A699234FAd5EE8851B65"
  erc20Swap = "0xf2e019a371e5Fd32dB2fC564Ad9eAE9E433133cc"

  [[citrea.tokens]]
  symbol = "cBTC"

  minWalletBalance = 100_000

  [[citrea.tokens]]
  symbol = "JUSD_CITREA"
  decimals = 6
  contractAddress = "0xFdB0a83d94CD65151148a131167Eb499Cb85d015"

  minWalletBalance = 1_000_000   # 1 JUSD_CITREA
